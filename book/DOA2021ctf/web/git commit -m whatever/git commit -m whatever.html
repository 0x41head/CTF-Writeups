<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>git commit -m &quot;whatever&quot; - CTF Writeups</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../../favicon.svg">
        <link rel="shortcut icon" href="../../../favicon.png">
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../../Introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="../../../PBJar-CTF-2021-Write-up/index.html"><strong aria-hidden="true">1.</strong> PBjar CTF 2021</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">1.1.</strong> Cryptography</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../PBJar-CTF-2021-Write-up/crypto/Convert/Convert.html"><strong aria-hidden="true">1.1.1.</strong> Convert</a></li><li class="chapter-item expanded "><a href="../../../PBJar-CTF-2021-Write-up/crypto/ReallynotSecureAlgorithm/ReallynotSecureAlgorithm.html"><strong aria-hidden="true">1.1.2.</strong> ReallynotSecureAlgorithm</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">1.2.</strong> Miscellaneous</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../PBJar-CTF-2021-Write-up/misc/discordplz/discordplz.html"><strong aria-hidden="true">1.2.1.</strong> discord plz</a></li><li class="chapter-item expanded "><a href="../../../PBJar-CTF-2021-Write-up/misc/miner/miner.html"><strong aria-hidden="true">1.2.2.</strong> miner</a></li><li class="chapter-item expanded "><a href="../../../PBJar-CTF-2021-Write-up/misc/TechLead/TechLead.html"><strong aria-hidden="true">1.2.3.</strong> TechLead</a></li><li class="chapter-item expanded "><a href="../../../PBJar-CTF-2021-Write-up/misc/readFlag1/readFlag1.html"><strong aria-hidden="true">1.2.4.</strong> readFlag1</a></li><li class="chapter-item expanded "><a href="../../../PBJar-CTF-2021-Write-up/misc/readFlag2/readFlag2.html"><strong aria-hidden="true">1.2.5.</strong> readFlag2</a></li><li class="chapter-item expanded "><a href="../../../PBJar-CTF-2021-Write-up/misc/readFlag3/readFlag3.html"><strong aria-hidden="true">1.2.6.</strong> readFlag3</a></li><li class="chapter-item expanded "><a href="../../../PBJar-CTF-2021-Write-up/misc/MEV/MEV.html"><strong aria-hidden="true">1.2.7.</strong> MEV</a></li><li class="chapter-item expanded "><a href="../../../PBJar-CTF-2021-Write-up/misc/Owner/Owner.html"><strong aria-hidden="true">1.2.8.</strong> Owner</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">1.3.</strong> Forensics</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../PBJar-CTF-2021-Write-up/forensics/ArtMystery/ArtMystery.html"><strong aria-hidden="true">1.3.1.</strong> Art Mystery</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../DeconstruCT.F/index.html"><strong aria-hidden="true">2.</strong> DeconstruCT.F 2021</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">2.1.</strong> Cryptography</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../DeconstruCT.F/Cryptography/RSA-1/RSA-1.html"><strong aria-hidden="true">2.1.1.</strong> RSA-1</a></li><li class="chapter-item expanded "><a href="../../../DeconstruCT.F/Cryptography/RSA-2/RSA-2.html"><strong aria-hidden="true">2.1.2.</strong> RSA-2</a></li><li class="chapter-item expanded "><a href="../../../DeconstruCT.F/Cryptography/RSA-3/RSA-3.html"><strong aria-hidden="true">2.1.3.</strong> RSA-3</a></li><li class="chapter-item expanded "><a href="../../../DeconstruCT.F/Cryptography/CodeDecode/CodeDecode.html"><strong aria-hidden="true">2.1.4.</strong> Code Decode</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.2.</strong> OSINT</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../DeconstruCT.F/OSINT/ExtendReality/ExtendReality.html"><strong aria-hidden="true">2.2.1.</strong> Extend Reality</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.3.</strong> Web</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../DeconstruCT.F/Web/Here's-a-flag/Here'saflag.html"><strong aria-hidden="true">2.3.1.</strong> Here's a flag</a></li><li class="chapter-item expanded "><a href="../../../DeconstruCT.F/Web/Please/Please.html"><strong aria-hidden="true">2.3.2.</strong> Please</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.4.</strong> Forensics</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../DeconstruCT.F/Forensics/Pirates/Pirates.html"><strong aria-hidden="true">2.4.1.</strong> Pirates</a></li><li class="chapter-item expanded "><a href="../../../DeconstruCT.F/Forensics/TegRads/TegRads.html"><strong aria-hidden="true">2.4.2.</strong> Teg Rads</a></li><li class="chapter-item expanded "><a href="../../../DeconstruCT.F/Forensics/The-Missing-Journalist/TheMissingJournalist.html"><strong aria-hidden="true">2.4.3.</strong> The Missing Journalist</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/index.html"><strong aria-hidden="true">3.</strong> Digital Overdose 2021 Autumn CTF</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.1.</strong> Hash Cracking</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Hash Cracking/Hash1/hash1.html"><strong aria-hidden="true">3.1.1.</strong> Hash 1</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Hash Cracking/Hash2/hash2.html"><strong aria-hidden="true">3.1.2.</strong> Hash 2</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Hash Cracking/Hash3/hash3.html"><strong aria-hidden="true">3.1.3.</strong> Hash 3</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Hash Cracking/Hash4/hash4.html"><strong aria-hidden="true">3.1.4.</strong> Hash 4</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Hash Cracking/Hash5/hash5.html"><strong aria-hidden="true">3.1.5.</strong> Hash 5</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Hash Cracking/Hash6/hash6.html"><strong aria-hidden="true">3.1.6.</strong> Hash 6</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Hash Cracking/Hash7/hash7.html"><strong aria-hidden="true">3.1.7.</strong> Hash 7</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.2.</strong> Source Analysis</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Source Analysis/A1 - C-naningans/C-nanigans.html"><strong aria-hidden="true">3.2.1.</strong> C-Nanigans</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.</strong> Reversing</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Reversing/Dyns, Syms, and Tabs/DynsSymsandTabs.html"><strong aria-hidden="true">3.3.1.</strong> Dyns, Syms, and Tabs</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.4.</strong> Miscellaneous</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Misc/Degrees/Degrees.html"><strong aria-hidden="true">3.4.1.</strong> Degrees</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.5.</strong> Steganography</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Steganography/A cornucopia of numbers/A cornucopia of numbers.html"><strong aria-hidden="true">3.5.1.</strong> A cornucopia of numbers</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Steganography/Queen's gambit/Queen's gambit.html"><strong aria-hidden="true">3.5.2.</strong> Queen's gambit</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Steganography/The Detective/The Detective.html"><strong aria-hidden="true">3.5.3.</strong> The Detective</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Steganography/Not exactly Nestene's Autons/Not exactly Nestene's Autons.html"><strong aria-hidden="true">3.5.4.</strong> Not exactly Nestene's Autons</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Steganography/Phreak File/Phreak File.html"><strong aria-hidden="true">3.5.5.</strong> Phreak File</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Steganography/Donald's youth/Donald's youth.html"><strong aria-hidden="true">3.5.6.</strong> Donald's youth</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.6.</strong> Cryptography</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Cryptography/Constant Primes/Constant Primes.html"><strong aria-hidden="true">3.6.1.</strong> Constant Primes</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Cryptography/Carousel/Carousel.html"><strong aria-hidden="true">3.6.2.</strong> Carousel</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Cryptography/Simply Cipher/Simply Cipher.html"><strong aria-hidden="true">3.6.3.</strong> Simply Cipher</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.7.</strong> Log Analysis</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Log Analysis/Ingress/Ingress.html"><strong aria-hidden="true">3.7.1.</strong> Ingress</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Log Analysis/Investigation/Investigation.html"><strong aria-hidden="true">3.7.2.</strong> Investigation</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/Log Analysis/Backup Policy/Backup Policy.html"><strong aria-hidden="true">3.7.3.</strong> Backup Policy</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.8.</strong> Web</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../DOA2021ctf/web/notrequired/notrequired.html"><strong aria-hidden="true">3.8.1.</strong> notrequired</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/web/git commit -m whatever/git commit -m whatever.html" class="active"><strong aria-hidden="true">3.8.2.</strong> git commit -m &quot;whatever&quot;</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.9.</strong> OSINT</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../DOA2021ctf/OSINT/Dare enter the mirror world/Dare enter the mirror world.html"><strong aria-hidden="true">3.9.1.</strong> Dare enter the mirror world</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/OSINT/The land of culture/The land of culture.html"><strong aria-hidden="true">3.9.2.</strong> The land of culture</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/OSINT/A childhood favourite/A childhood favourite.html"><strong aria-hidden="true">3.9.3.</strong> A childhood favourite</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/OSINT/One of the classics/One of the classics.html"><strong aria-hidden="true">3.9.4.</strong> One of the classics</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/OSINT/The Central Hub/The Central Hub.html"><strong aria-hidden="true">3.9.5.</strong> The Central Hub</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/OSINT/This way, Emperor Naruhito/This way, Emperor Naruhito.html"><strong aria-hidden="true">3.9.6.</strong> This way, Emperor Naruhito</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/OSINT/A staple drink of Japan/A staple drink of Japan.html"><strong aria-hidden="true">3.9.7.</strong> A staple drink of Japan</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/OSINT/An island of mascots/An island of mascots.html"><strong aria-hidden="true">3.9.8.</strong> An island of mascots</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/OSINT/A story of the ages/A story of the ages.html"><strong aria-hidden="true">3.9.9.</strong> A story of the ages</a></li><li class="chapter-item expanded "><a href="../../../DOA2021ctf/OSINT/The river of Sakura/The river of Sakura.html"><strong aria-hidden="true">3.9.10.</strong> The river of Sakura</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">CTF Writeups</h1>

                    <div class="right-buttons">
                        <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="problem-statement"><a class="header" href="#problem-statement">Problem Statement:</a></h1>
<p><img src="https://raw.githubusercontent.com/0x41head/CTF-Writeups/main/src/DOA2021ctf/web/git%20commit%20-m%20whatever/ques.png" alt="question" /></p>
<h2 id="solution"><a class="header" href="#solution">Solution:</a></h2>
<p>Going to the URL mentioned in the qustion we are greeted with this:
<img src="https://raw.githubusercontent.com/0x41head/CTF-Writeups/main/src/DOA2021ctf/web/git%20commit%20-m%20whatever/1.png" alt="1" /></p>
<p>Brute forcing the directory of this webpage we can see that there is a <code>.git/HEAD</code> present</p>
<pre><code>$ dirb http://193.57.159.27:53329

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Tue Oct 12 15:31:52 2021
URL_BASE: http://193.57.159.27:53329/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: 4612                                                          

---- Scanning URL: http://193.57.159.27:53329/ ----
+ http://193.57.159.27:53329/.git/HEAD (CODE:200|SIZE:24) 
</code></pre>
<p>Searching for this related it to <code>git</code> in webpages, I found <a href="https://github.com/internetwache/GitTools/blob/master/Dumper/gitdumper.sh">GitDumper</a></p>
<p>I used it to download all the files in .git folder</p>
<pre><code>$ ./gitdumper.sh http://193.57.159.27:53329/.git/ dumped_files
###########
# GitDumper is part of https://github.com/internetwache/GitTools
#
# Developed and maintained by @gehaxelt from @internetwache
#
# Use at your own risk. Usage might be illegal in certain circumstances. 
# Only for educational purposes!
###########


[+] Downloaded: HEAD
[-] Downloaded: objects/info/packs
[+] Downloaded: description
[+] Downloaded: config
[+] Downloaded: COMMIT_EDITMSG
[+] Downloaded: index
[-] Downloaded: packed-refs
[+] Downloaded: refs/heads/master
[-] Downloaded: refs/remotes/origin/HEAD
[-] Downloaded: refs/stash
[+] Downloaded: logs/HEAD
[+] Downloaded: logs/refs/heads/master
[-] Downloaded: logs/refs/remotes/origin/HEAD
[-] Downloaded: info/refs
[+] Downloaded: info/exclude
[-] Downloaded: /refs/wip/index/refs/heads/master
[-] Downloaded: /refs/wip/wtree/refs/heads/master
[+] Downloaded: objects/27/56250c7cd2188bdf8c4cdeddc92bcbe13f1755
[-] Downloaded: objects/00/00000000000000000000000000000000000000
[+] Downloaded: objects/c2/c1d8bde15fa2174d6acd1284d7251579b8a1b4
[+] Downloaded: objects/4f/bdfd5fda330754872764810dfa2c1ef46f1bb0
[+] Downloaded: objects/49/79a80a4c88cdbb529b51aa231caff61d9228a0
[+] Downloaded: objects/46/5e79b104f83169a4f95900a6a9f42b34e71892
[+] Downloaded: objects/3a/8a916693a0d0acf0320d287318d9ddd123cbe3
[+] Downloaded: objects/07/2aad170b0a780723ef2c690a3fe4f5e3392830
[+] Downloaded: objects/95/d5d6fbb14df57d143ec73df6dc00807f85b1db
[+] Downloaded: objects/0d/4096f89f4ea65a44c2a4038b6f931c95c5eba4
[+] Downloaded: objects/58/a1261b18cc493ba5be1c4ef8f04d258716e419
[+] Downloaded: objects/93/457a2717c9b3196924f76cdf5e30a3e3e91013
[+] Downloaded: objects/bd/9550631ebc3e52df59fb17ca77a08349f318de
[+] Downloaded: objects/17/6a3e14009956fb5eb865f0d059b2db8ed19c07
[+] Downloaded: objects/3c/ec2498dd9929460a8d0cf37e2b9bc3a3964ef6
[+] Downloaded: objects/a7/a4dd98ca6aea65d8263027d26be7a0ef93c4fe
[+] Downloaded: objects/3d/10547f81124a6c5486d37b9372dbd0c9665b4e
[+] Downloaded: objects/51/d5d44ec34588b8996e059840a2a83b70cfa1f7
[+] Downloaded: objects/7b/64c8f6a27ef08579d3bb8fba5e180784beb177
[+] Downloaded: objects/e3/4b27aa5094d032331bd2ce6a0533c646457edf
[+] Downloaded: objects/64/74726b8271cef222bbc8f15f5929cc11aea50e
[+] Downloaded: objects/2a/a684a04e0d8bfed9ebb53ac339a301021c8910
[+] Downloaded: objects/cf/628a4a35910bb0161801f290a2fa38b1e4a596
[+] Downloaded: objects/98/dcb0ff422cbed170c1f1f620ef912d977cfab0
[+] Downloaded: objects/d0/23c46792e96174ccb9218dfad376aab76f0133
[+] Downloaded: objects/4d/d1a0618effc5117615b7a275b3f0983d7bd8ea
[+] Downloaded: objects/e5/0a9600bd4708631c8bc01b319364afaffab94a
[+] Downloaded: objects/41/036870066f9473b83997a9144d2b56f26482e5
[+] Downloaded: objects/5e/ee568e29ee440e93266d007769f1987ba1dff2
[+] Downloaded: objects/93/a04a076cbfb06378292e5b2f9e21a0960a9d21
[+] Downloaded: objects/12/821190c4f46f8d0fd1efea082e54393d2bced3
[+] Downloaded: objects/fc/1f98f6017e2e49df069cf27917731a3b73bca2
[+] Downloaded: objects/5e/b684e2b3288349df63acc7a51c1b82058c16cb
[+] Downloaded: objects/28/00ea0071c9e01b0967726defc26e451ddf7946
[-] Downloaded: objects/70/14a0eb6d1611151a286c0ff4f2238f92c120d6
[+] Downloaded: objects/5b/e48926566ff0c6ff1b14fe369969054843e31b
[+] Downloaded: objects/9f/ed183bcaa6da1ad6a0b6d46e151cd28553ef1a
</code></pre>
<p>After checking the reference <code>master</code></p>
<pre><code>$  cat .git/refs/heads/master 
2756250c7cd2188bdf8c4cdeddc92bcbe13f1755
</code></pre>
<p>I saw that it pointed to a commit with the hash <code>2756250c7cd2188bdf8c4cdeddc92bcbe13f1755</code></p>
<p>I tried using <code>cat</code> to find a bit more information about it.</p>
<pre><code>$ git cat-file -p 2756250c7cd2188bdf8c4cdeddc92bcbe13f1755
tree c2c1d8bde15fa2174d6acd1284d7251579b8a1b4
author elliot &lt;macuser@Macs-MacBook-Air.local&gt; 1633254410 +0530
committer elliot &lt;macuser@Macs-MacBook-Air.local&gt; 1633254410 +0530

Committed security suicide
</code></pre>
<p>Next, I tried looking more into the <code>tree</code> hash and found the hash for the <code>index.php</code> file</p>
<pre><code>$ git cat-file -p c2c1d8bde15fa2174d6acd1284d7251579b8a1b4
040000 tree 4fbdfd5fda330754872764810dfa2c1ef46f1bb0    Crypt
040000 tree 4979a80a4c88cdbb529b51aa231caff61d9228a0    File
040000 tree 465e79b104f83169a4f95900a6a9f42b34e71892    Math
040000 tree 3a8a916693a0d0acf0320d287318d9ddd123cbe3    Net
040000 tree 072aad170b0a780723ef2c690a3fe4f5e3392830    System
100644 blob 95d5d6fbb14df57d143ec73df6dc00807f85b1db    bootstrap.php
100644 blob 0d4096f89f4ea65a44c2a4038b6f931c95c5eba4    index.php
100644 blob 58a1261b18cc493ba5be1c4ef8f04d258716e419    openssl.cnf
</code></pre>
<p>Using <code>cat</code> on the <code>index.php</code> hash gave me the source code of the webpage</p>
<pre><code>$ git cat-file -p 0d4096f89f4ea65a44c2a4038b6f931c95c5eba4
&lt;?php

/**
 * Simple sodium crypto class for PHP &gt;= 7.2
 * @author MRK
 */
class crypto {

    /**
     * 
     * @return type
     */
    static public function create_encryption_key() {
        return base64_encode(sodium_crypto_secretbox_keygen());
    }

    /**
     * Encrypt a message
     * 
     * @param string $message - message to encrypt
     * @param string $key - encryption key created using create_encryption_key()
     * @return string
     */
    static function encrypt($message, $key) {
        $key_decoded = base64_decode($key);
        $nonce = random_bytes(
                SODIUM_CRYPTO_SECRETBOX_NONCEBYTES
        );

        $cipher = base64_encode(
                $nonce .
                sodium_crypto_secretbox(
                        $message, $nonce, $key_decoded
                )
        );
        sodium_memzero($message);
        sodium_memzero($key_decoded);
        return $cipher;
    }

    /**
     * Decrypt a message
     * @param string $encrypted - message encrypted with safeEncrypt()
     * @param string $key - key used for encryption
     * @return string
     */
    static function decrypt($encrypted, $key) {
        $decoded = base64_decode($encrypted);
        $key_decoded = base64_decode($key);
        if ($decoded === false) {
            throw new Exception('Decryption error : the encoding failed');
        }
        if (mb_strlen($decoded, '8bit') &lt; (SODIUM_CRYPTO_SECRETBOX_NONCEBYTES + SODIUM_CRYPTO_SECRETBOX_MACBYTES)) {
            throw new Exception('Decryption error : the message was truncated');
        }
        $nonce = mb_substr($decoded, 0, SODIUM_CRYPTO_SECRETBOX_NONCEBYTES, '8bit');
        $ciphertext = mb_substr($decoded, SODIUM_CRYPTO_SECRETBOX_NONCEBYTES, null, '8bit');

        $plain = sodium_crypto_secretbox_open(
                $ciphertext, $nonce, $key_decoded
        );
        if ($plain === false) {
            throw new Exception('Decryption error : the message was tampered with in transit');
        }
        sodium_memzero($ciphertext);
        sodium_memzero($key_decoded);
        return $plain;
    }

}

$privatekey = &quot;mRHpcEckKATdwDC/CwpRinDTiAYrn9lzWpTo277omKs=&quot;;

$flag = file_get_contents('../flag.txt');

$enc = crypto::encrypt($flag, $privatekey);

echo $enc;

?&gt;

&lt;html&gt;
    &lt;br&gt;
    Only if you could see the source code.
&lt;/html&gt;

</code></pre>
<p>I could now see that there was an <code>encrypt</code> and <code>decrypt</code> function in the source along with a <code>$privatekey</code>.</p>
<p>Copy pasting this code into my own system and using the <code>decrypt</code> function with the <code>$privatekey</code> and the encrypted text on the webage we were able to retrieve the flag </p>
<pre><code>crypto::decrypt(&quot;8tjVQ5fKbDlkzPk3xX4LQvb6ndFJa+sT/0VnRgAwhTfUFMyYgm/aGJWKV518+p9HH8YT2XpOuz6JiDlBtZBFkzbliEScNvtgnL4Xga0O&quot;,$privatekey);
</code></pre>
<h3 id="notes"><a class="header" href="#notes">Notes:</a></h3>
<h3 id="reference"><a class="header" href="#reference">Reference:</a></h3>
<p>https://ctftime.org/writeup/23835</p>
<p>https://en.internetwache.org/dont-publicly-expose-git-or-how-we-downloaded-your-websites-sourcecode-an-analysis-of-alexas-1m-28-07-2015/</p>
<h3 id="tags"><a class="header" href="#tags">Tags:</a></h3>
<p><code>Web</code> <code>git</code> </p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../DOA2021ctf/web/notrequired/notrequired.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../../../DOA2021ctf/OSINT/Dare enter the mirror world/Dare enter the mirror world.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../DOA2021ctf/web/notrequired/notrequired.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../../../DOA2021ctf/OSINT/Dare enter the mirror world/Dare enter the mirror world.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
